<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Tab Close Test - RDMasterX</title>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
            margin: 0;
            padding: 20px;
            background-color: #f5f5f5;
        }
        
        .test-container {
            max-width: 800px;
            margin: 0 auto;
            background: white;
            border-radius: 8px;
            padding: 20px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        
        h1 {
            color: #333;
            margin-bottom: 20px;
        }
        
        .status {
            padding: 15px;
            margin: 10px 0;
            border-radius: 6px;
            font-weight: 500;
        }
        
        .success {
            background-color: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
        }
        
        .info {
            background-color: #d1ecf1;
            color: #0c5460;
            border: 1px solid #bee5eb;
        }
        
        .test-tabs {
            display: flex;
            border-bottom: 2px solid #e9ecef;
            margin: 20px 0;
        }
        
        .test-tab {
            display: flex;
            align-items: center;
            padding: 10px 15px;
            background: #f8f9fa;
            border: 1px solid #dee2e6;
            border-bottom: none;
            margin-right: 2px;
            cursor: pointer;
            transition: all 0.2s ease;
        }
        
        .test-tab.active {
            background: #007bff;
            color: white;
            border-color: #007bff;
        }
        
        .test-tab:hover {
            background: #e9ecef;
        }
        
        .test-tab.active:hover {
            background: #0056b3;
        }
        
        .tab-name {
            margin-right: 10px;
            font-weight: 500;
        }
        
        .test-close-btn {
            width: 20px;
            height: 20px;
            border-radius: 4px;
            border: none;
            background: transparent;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 16px;
            color: #666;
            transition: all 0.2s ease;
        }
        
        .test-close-btn:hover {
            background: rgba(0,0,0,0.1);
            color: #000;
        }
        
        .test-tab.active .test-close-btn {
            color: rgba(255,255,255,0.8);
        }
        
        .test-tab.active .test-close-btn:hover {
            background: rgba(255,255,255,0.2);
            color: white;
        }
        
        .test-content {
            padding: 20px;
            background: #f8f9fa;
            border-radius: 0 0 8px 8px;
            min-height: 150px;
        }
        
        .no-tabs {
            text-align: center;
            color: #666;
            font-style: italic;
            padding: 40px;
        }
        
        .test-results {
            margin-top: 20px;
        }
        
        .test-step {
            margin: 10px 0;
            padding: 10px;
            background: #f8f9fa;
            border-radius: 4px;
            border-left: 4px solid #007bff;
        }
        
        .reset-btn {
            background: #28a745;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 4px;
            cursor: pointer;
            margin-top: 20px;
        }
        
        .reset-btn:hover {
            background: #218838;
        }
    </style>
</head>
<body>
    <div class="test-container">
        <h1>üìã Tab Close Button Test</h1>
        
        <div class="status success">
            ‚úÖ <strong>Fixed Implementation:</strong> Tab close buttons now work properly with correct behavior
        </div>
        
        <div class="status info">
            ‚ÑπÔ∏è <strong>Expected Behavior:</strong><br>
            ‚Ä¢ Click "√ó" to close a tab<br>
            ‚Ä¢ If multiple tabs: switch to previous tab<br>
            ‚Ä¢ If only one tab: close it and return to main dashboard<br>
            ‚Ä¢ Button should be clearly visible and responsive
        </div>
        
        <div class="test-tabs" id="testTabs">
            <div class="test-tab active" data-tab="tab1">
                <span class="tab-name">DC01 - Domain Controller</span>
                <button class="test-close-btn" onclick="closeTestTab(event, 'tab1')">√ó</button>
            </div>
            <div class="test-tab" data-tab="tab2">
                <span class="tab-name">WEB01 - Web Server</span>
                <button class="test-close-btn" onclick="closeTestTab(event, 'tab2')">√ó</button>
            </div>
            <div class="test-tab" data-tab="tab3">
                <span class="tab-name">DB01 - Database</span>
                <button class="test-close-btn" onclick="closeTestTab(event, 'tab3')">√ó</button>
            </div>
        </div>
        
        <div class="test-content" id="testContent">
            <div id="tab1-content">
                <h3>DC01 - Domain Controller</h3>
                <p><strong>Status:</strong> Connected</p>
                <p><strong>IP:</strong> 192.168.1.10</p>
                <p>This demonstrates the tab close functionality. Try clicking the √ó button on any tab.</p>
            </div>
            <div id="tab2-content" style="display: none;">
                <h3>WEB01 - Web Server</h3>
                <p><strong>Status:</strong> Connected</p>
                <p><strong>IP:</strong> 192.168.1.20</p>
                <p>Web server content. Close this tab to see the behavior.</p>
            </div>
            <div id="tab3-content" style="display: none;">
                <h3>DB01 - Database</h3>
                <p><strong>Status:</strong> Connected</p>
                <p><strong>IP:</strong> 192.168.1.30</p>
                <p>Database server content. Test closing this tab.</p>
            </div>
            <div id="no-tabs-content" style="display: none;">
                <div class="no-tabs">
                    <h3>üè† Main Dashboard</h3>
                    <p>All tabs have been closed. You're back to the main dashboard.</p>
                    <p>This is the expected behavior when the last tab is closed.</p>
                </div>
            </div>
        </div>
        
        <div class="test-results">
            <h3>Test Results:</h3>
            <div id="testLog"></div>
        </div>
        
        <button class="reset-btn" onclick="resetTest()">Reset Test</button>
    </div>

    <script>
        let testLog = [];
        let activeTab = 'tab1';
        
        function logTest(message) {
            testLog.push(message);
            updateTestLog();
        }
        
        function updateTestLog() {
            const logDiv = document.getElementById('testLog');
            logDiv.innerHTML = testLog.map((msg, index) => 
                `<div class="test-step">${index + 1}. ${msg}</div>`
            ).join('');
        }
        
        function closeTestTab(event, tabId) {
            event.stopPropagation();
            event.preventDefault();
            
            logTest(`Close button clicked for tab: ${tabId}`);
            
            // Find current tab and all tabs
            const currentTab = document.querySelector(`[data-tab="${tabId}"]`);
            const allTabs = Array.from(document.querySelectorAll('.test-tab'));
            const currentIndex = allTabs.indexOf(currentTab);
            
            // Remove the tab
            currentTab.remove();
            
            // Hide the content
            const content = document.getElementById(`${tabId}-content`);
            if (content) {
                content.style.display = 'none';
            }
            
            // Get remaining tabs
            const remainingTabs = Array.from(document.querySelectorAll('.test-tab'));
            
            if (remainingTabs.length > 0) {
                // Switch to previous tab or first tab
                let newActiveIndex;
                if (currentIndex > 0) {
                    newActiveIndex = Math.min(currentIndex - 1, remainingTabs.length - 1);
                    logTest(`Switching to previous tab (index ${newActiveIndex})`);
                } else {
                    newActiveIndex = 0;
                    logTest(`Switching to first remaining tab (index ${newActiveIndex})`);
                }
                
                const newActiveTab = remainingTabs[newActiveIndex];
                const newActiveTabId = newActiveTab.getAttribute('data-tab');
                
                // Remove active class from all tabs
                remainingTabs.forEach(tab => tab.classList.remove('active'));
                
                // Add active class to new tab
                newActiveTab.classList.add('active');
                
                // Show new content
                const newContent = document.getElementById(`${newActiveTabId}-content`);
                if (newContent) {
                    newContent.style.display = 'block';
                }
                
                activeTab = newActiveTabId;
                logTest(`‚úÖ Successfully switched to tab: ${newActiveTabId}`);
            } else {
                // No tabs remaining - show main dashboard
                logTest(`No tabs remaining - returning to main dashboard`);
                document.getElementById('no-tabs-content').style.display = 'block';
                activeTab = null;
                logTest(`‚úÖ Successfully returned to main dashboard`);
            }
        }
        
        function resetTest() {
            // Reset tabs
            document.getElementById('testTabs').innerHTML = `
                <div class="test-tab active" data-tab="tab1">
                    <span class="tab-name">DC01 - Domain Controller</span>
                    <button class="test-close-btn" onclick="closeTestTab(event, 'tab1')">√ó</button>
                </div>
                <div class="test-tab" data-tab="tab2">
                    <span class="tab-name">WEB01 - Web Server</span>
                    <button class="test-close-btn" onclick="closeTestTab(event, 'tab2')">√ó</button>
                </div>
                <div class="test-tab" data-tab="tab3">
                    <span class="tab-name">DB01 - Database</span>
                    <button class="test-close-btn" onclick="closeTestTab(event, 'tab3')">√ó</button>
                </div>
            `;
            
            // Reset content
            document.getElementById('tab1-content').style.display = 'block';
            document.getElementById('tab2-content').style.display = 'none';
            document.getElementById('tab3-content').style.display = 'none';
            document.getElementById('no-tabs-content').style.display = 'none';
            
            // Reset state
            activeTab = 'tab1';
            testLog = [];
            updateTestLog();
            
            logTest(`üîÑ Test reset - all tabs restored`);
        }
        
        // Tab switching
        document.addEventListener('click', function(event) {
            const tab = event.target.closest('.test-tab');
            if (tab && !event.target.classList.contains('test-close-btn')) {
                // Remove active from all tabs
                document.querySelectorAll('.test-tab').forEach(t => t.classList.remove('active'));
                
                // Hide all content
                document.querySelectorAll('[id$="-content"]').forEach(c => c.style.display = 'none');
                
                // Activate clicked tab
                tab.classList.add('active');
                const tabId = tab.getAttribute('data-tab');
                document.getElementById(`${tabId}-content`).style.display = 'block';
                
                activeTab = tabId;
                logTest(`Switched to tab: ${tabId}`);
            }
        });
        
        // Initial log
        logTest(`üöÄ Test initialized with 3 tabs`);
    </script>
</body>
</html>
